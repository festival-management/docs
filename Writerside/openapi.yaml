openapi: "3.1.0"
info:
  title: "FestivalBackend"
  version: "0.1.0"
paths:
  /auth/token/:
    post:
      tags:
        - "auth"
      summary: "Login"
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/LoginItem"
        required: "true"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /auth/register/:
    post:
      tags:
        - "auth"
      summary: "Register"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterItem"
        required: "true"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegisterUserResponse"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /roles/:
    post:
      tags:
        - "roles"
      summary: "Create Role"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRoleItem"
        required: "true"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateRoleResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
    get:
      tags:
        - "roles"
      summary: "Get Roles"
      parameters:
        - name: "offset"
          in: "query"
          required: "false"
          schema:
            type: "integer"
            default: "0"
            title: "Offset"
        - name: "limit"
          in: "query"
          required: "false"
          schema:
            type: "integer"
            default: "null"
            title: "Limit"
        - name: "only_name"
          in: "query"
          required: "false"
          schema:
            type: "boolean"
            default: "false"
            title: "Only Name"
        - name: "can_order"
          in: "query"
          required: "false"
          schema:
            type: "boolean"
            default: "false"
            title: "Can Order"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetRolesResponse"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /roles/{role_id}:
    delete:
      tags:
        - "roles"
      summary: "Delete Role"
      parameters:
        - name: "role_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "Role Id"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
    get:
      tags:
        - "roles"
      summary: "Get Role"
      parameters:
        - name: "role_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "Role Id"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetRoleResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /roles/{role_id}/permissions:
    put:
      tags:
        - "roles"
      summary: "Update Role Permissions"
      parameters:
        - name: "role_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "Role Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateRolePermissionsItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /roles/{role_id}/name:
    put:
      tags:
        - "roles"
      summary: "Update Role Name"
      parameters:
        - name: "role_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "Role Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateRoleNameItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /roles/{role_id}/paper_size:
    put:
      tags:
        - "roles"
      summary: "Update Role Paper Size"
      parameters:
        - name: "role_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "Role Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateRolePaperSizeItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /users/{user_id}:
    delete:
      tags:
        - "users"
      summary: "Delete User"
      parameters:
        - name: "user_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "User Id"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
    get:
      tags:
        - "users"
      summary: "Get User"
      parameters:
        - name: "user_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "User Id"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUserResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /users/:
    get:
      tags:
        - "users"
      summary: "Get Users"
      parameters:
        - name: "offset"
          in: "query"
          required: "false"
          schema:
            type: "integer"
            default: "0"
            title: "Offset"
        - name: "limit"
          in: "query"
          required: "false"
          schema:
            type: "integer"
            default: "100"
            title: "Limit"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetUsersResponse"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /users/{user_id}/password:
    put:
      tags:
        - "users"
      summary: "Update User Password"
      parameters:
        - name: "user_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "User Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateUserPasswordItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /users/{user_id}/name:
    put:
      tags:
        - "users"
      summary: "Update User Name"
      parameters:
        - name: "user_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "User Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateUserNameItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        409:
          description: "Conflict"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
  /users/{user_id}/role:
    put:
      tags:
        - "users"
      summary: "Update User Role"
      parameters:
        - name: "user_id"
          in: "path"
          required: "true"
          schema:
            type: "integer"
            title: "User Id"
      requestBody:
        required: "true"
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UpdateUserRoleItem"
      responses:
        200:
          description: "Successful Response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        400:
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        401:
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        404:
          description: "Not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
        422:
          description: "Validation Error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseResponse"
components:
  schemas:
    BaseResponse:
      properties:
        error:
          type: "boolean"
          title: "Error"
          default: "false"
        code:
          type: "integer"
          title: "Code"
          default: "0"
        message:
          type: "string"
          title: "Message"
          default: ""
      type: "object"
      title: "BaseResponse"
    PaperSize:
      type: "string"
      enum:
        - "A4"
      const: "A4"
      title: "PaperSize"
    User:
      properties:
        id:
          type: "integer"
          title: "Id"
        username:
          type: "string"
          title: "Username"
        role_id:
          type: "integer"
          title: "Role Id"
        created_at:
          type: "string"
          format: "date-time"
          title: "Created At"
      type: "object"
      "required":
        - "id"
        - "username"
        - "role_id"
        - "created_at"
      title: "User"
    LoginItem:
      properties:
        grant_type:
          anyOf:
            - type: "string"
              pattern: "password"
            - type: "null"
          title: "Grant Type"
        username:
          type: "string"
          title: "Username"
        password:
          type: "string"
          title: "Password"
        scope:
          type: "string"
          title: "Scope"
          default: ""
        client_id:
          anyOf:
            - type: "string"
            - type: "null"
          title: "Client Id"
        client_secret:
          anyOf:
            - type: "string"
            - type: "null"
          title: "Client Secret"
      type: "object"
      required:
        - "username"
        - "password"
      title: "LoginItem"
    LoginResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: "object"
          properties:
            access_token:
              type: "string"
              title: "Access Token"
            token_type:
              type: "string"
              title: "Token Type"
              default: "bearer"
          required:
            - "access_token"
          title: "LoginResponse"
    RegisterItem:
      properties:
        username:
          type: "string"
          title: "Username"
        password:
          type: "string"
          title: "Password"
        role_id:
          type: "integer"
          title: "Role Id"
      type: "object"
      required:
        - "username"
        - "password"
        - "role_id"
    RegisterUserResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: "object"
          properties:
            user:
              $ref: "#/components/schemas/User"
          required:
            - "user"
          title: "RegisterUserResponse"
    Role:
      properties:
        id:
          type: "integer"
          title: "Id"
        name:
          type: "integer"
          title: "Name"
        permissions:
          additionalProperties:
            type: "boolean"
          type: "object"
          title: "Permissions"
        paper_size:
          anyOf:
            - $ref: "#/components/schemas/PaperSize"
            - type: "null"
      type: "object"
      required:
        - "id"
        - "name"
        - "permissions"
        - "paper_size"
      title: "Role"
    RoleName:
      properties:
        id:
          type: "integer"
          title: "Id"
        name:
          type: "string"
          title: "Name"
      type: "object"
      required:
        - "id"
        - "name"
      title: "RoleName"
    CreateRoleItem:
      properties:
        name:
          type: "string"
          title: "Name"
      type: "object"
      required:
        - "name"
    CreateRoleResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: "object"
          properties:
            role:
              $ref: "#/components/schemas/Role"
          required:
            - "role"
          title: "CreateRoleResponse"
    GetRoleResponse:
      allOf:
        - $ref: "#/components/schemas/Role"
    GetRolesResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: "object"
          properties:
            total_count:
              type: "integer"
              title: "Total Count"
            roles:
              type: "array"
              items:
                anyOf:
                  - $ref: "#/components/schemas/Role"
                  - $ref: "#/components/schemas/RoleName"
              title: "Roles"
          required:
            - "total_count"
            - "roles"
          title: "GetRolesResponse"
    UpdateRolePermissionsItem:
      properties:
        permissions:
          additionalProperties:
            type: "boolean"
          type: "object"
          title: "Permissions"
      type: "object"
      required:
        - "permissions"
      title: "UpdateRolePermissionsItem"
    UpdateRoleNameItem:
      properties:
        name:
          type: "string"
          title: "Name"
      type: "object"
      required:
        - "name"
      title: "UpdateRoleNameItem"
    UpdateRolePaperSizeItem:
      properties:
        paper_size:
          "$ref": "#/components/schemas/PaperSize"
      type: "object"
      required:
        - "paper_size"
      title: "UpdateRolePaperSizeItem"
    GetUserResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - $ref: "#/components/schemas/User"
          title: "GetUserResponse"
    GetUsersResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: "object"
          properties:
            total_count:
              type: "integer"
              title: "Total Count"
            users:
              items:
                "$ref": "#/components/schemas/User"
              type: "array"
              title: "Users"
          required:
            - "total_count"
            - "users"
          title: "GetUsersResponse"
    UpdateUserPasswordItem:
      properties:
        password:
          type: "string"
          title: "Password"
      type: "object"
      required:
        - "password"
      title: "UpdateUserPasswordItem"
    UpdateUserNameItem:
      properties:
        username:
          type: "string"
          title: "Username"
      type: "object"
      required:
        - "username"
      title: "UpdateUserNameItem"
    UpdateUserRoleItem:
      properties:
        role_id:
          type: "integer"
          title: "Role Id"
      type: "object"
      required:
        - "role_id"
      title: "UpdateUserRoleItem"
